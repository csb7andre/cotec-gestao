<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COTEC | Gest√£o Policial</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script defer src="app.js"></script>
    <link rel="icon" type="image/png" href="1770196336247.png">
    <link rel="manifest" href="manifest.json">
</head>
<body>

<nav class="navbar">          
    <div class="nav-brand">
        <img src="LOGO.jpg" alt="Logo" class="brand-logo" onerror="this.style.display='none'">
        <div class="brand-text">
            <h1>GEST√ÉO COTEC</h1>
            <span>COORDENA√á√ÉO DE GEST√ÉO DE TECNOLOGIAS POLICIAIS E CREDENCIAMENTO</span>
        </div>
    </div>
    
    <div class="nav-shortcuts">
        <a href="#section-demandas">Demandas</a>
        <a href="#section-reunioes">Reuni√µes</a>
        <a href="#section-projetos">Projetos</a>
        <img src="1770196336247.png" alt="Icone Atalho" class="shortcut-img">
    </div>
</nav>

<main class="container">
    <div class="dashboard-grid">
        <aside class="config-sidebar">
            <section class="glass-card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px">
                    <h3>Equipe</h3>
                    <button class="btn-sm-sync" onclick="carregarDadosDoServidor()" title="Sincronizar dados com a nuvem">üîÑ</button>
                </div>
                <div class="input-group">
                    <input id="novoMembro" placeholder="Nome...">
                    <button class="btn-accent" onclick="addMembro()" title="Adicionar novo agente">+</button>
                </div>
                <ul id="listaMembros" class="item-list"></ul>
                <small style="color:#666; font-size:0.7rem; display:block; margin-top:5px">Arraste os nomes para reordenar</small>
            </section>
            <section class="glass-card" style="margin-top:20px">
                <h3>Tarefas Base</h3>
                <div class="input-group">
                    <input id="novaTarefa" placeholder="Tarefa...">
                    <button class="btn-accent" onclick="addTarefa()" title="Adicionar nova tarefa">+</button>
                </div>
                <ul id="listaTarefas" class="item-list"></ul>
            </section>
        </aside>

        <div class="operational-area">
            <div class="glass-card toggle-header" onclick="toggleMainSection()" title="Clique para expandir/recolher a √°rea de escala">
                <h2 style="margin:0; font-size:1.1rem">PAINEL DE ESCALA E DISTRIBUI√á√ÉO</h2>
                <span id="setaMainSection">‚ñº</span>
            </div>

            <div id="mainSectionContent" style="display:none; margin-top:15px">
                <div class="selection-row" style="display:flex; gap:15px; margin-bottom:20px">
                    <section class="glass-card" style="flex:1">
                        <h3>Presen√ßa</h3>
                        <div id="presentes" class="chip-container"></div>
                    </section>
                    <section class="glass-card" style="flex:1">
                        <h3>Ativar na Escala</h3>
                        <div id="tarefasHoje" class="chip-container"></div>
                    </section>
                </div>

                <section class="glass-card">
                    <div style="display:flex; justify-content:space-between">
                        <h3>Distribui√ß√£o</h3>
                        <button class="btn-reset" onclick="resetarPainelEscala()" title="Limpar todos os agentes das tarefas">Limpar</button>
                    </div>
                    <div id="painelTarefas" class="painel-tarefas-grid"></div>
                </section>

                <div style="margin-top:20px; display:flex; gap:10px;">
                    <button class="btn-mega" onclick="gerarEscala('HOJE')" title="Gerar escala com a data de hoje">GERAR ESCALA DO DIA</button>
                    <button class="btn-mega btn-secundario" onclick="abrirModalData()" title="Escolher data espec√≠fica ou per√≠odo">ESCALA OUTRA DATA</button>
                </div>
            </div>
            
            <section id="resultSection" class="glass-card hidden" style="margin-top:20px">
                <h3 id="tituloEscalaGerada"></h3>
                <div id="resultado"></div>
                
                <div class="export-controls" style="margin-top:15px; background:#f8fafc; padding:10px; border-radius:8px;">
                    <label style="font-size:0.8rem; font-weight:bold;">Exportar para:</label>
                    <div style="display:flex; gap:10px; margin:5px 0 10px 0;">
                        <select id="exportTarget" onchange="toggleExportSelect()" style="padding:5px; border-radius:4px; border:1px solid #ccc;">
                            <option value="todos">Toda a Equipe</option>
                            <option value="individual">Individual</option>
                        </select>
                        <select id="exportIndividualSelect" style="display:none; padding:5px; border-radius:4px; border:1px solid #ccc;"></select>
                    </div>

                    <div style="display:flex; gap:10px">
                        <button class="btn-exp" onclick="executarExport('print')" title="Imprimir Relat√≥rio">üñ®Ô∏è Imprimir</button>
                        <button class="btn-exp" onclick="executarExport('word')" title="Baixar documento Word">üìÑ Word</button>
                        <button class="btn-exp" style="color:#25D366; border-color:#25D366" onclick="executarExport('whats')" title="Enviar Texto via WhatsApp">üì≤ WhatsApp</button>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <hr style="margin:40px 0">

    <section id="section-demandas" class="glass-card">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
            <div class="header-with-sync" onclick="toggleDemandas()" title="Expandir/Recolher Demandas">
                <span id="setaDemandas">‚ñº</span>
                <h2 style="margin:0">
                    <span id="tituloDemandas">Acompanhamento de Demandas</span>
                    <span id="contadorDemandas"></span>
                </h2>
                <button class="btn-sm-sync" onclick="event.stopPropagation(); carregarDadosDoServidor()" title="Sincronizar Demandas">üîÑ</button>
            </div>
            <button class="btn-accent" onclick="novaDemanda()" title="Criar nova demanda">+ Nova Demanda</button>
        </div>
        <div id="listaDemandas"></div>
        
        <div id="footerDemandas" style="margin-top:20px; background:#f1f5f9; padding:15px; border-radius:8px; display:flex; justify-content:space-between;">
             <div>
                <b>A√ß√µes em Lote:</b>
                <button class="btn-exp" onclick="exportarDemandasLote('print')" title="Imprimir lista de demandas">üñ®Ô∏è</button>
                <button class="btn-exp" onclick="exportarDemandasLote('whats')" title="Enviar lista por WhatsApp">üì≤</button>
                <button class="btn-exp" onclick="exportarDemandasLote('word')" title="Baixar lista em Word">üìÑ</button>
             </div>
             <button class="btn-reset" onclick="abrirDemandasConcluidas()" title="Ver hist√≥rico de conclu√≠das">VER CONCLU√çDAS</button>
        </div>
    </section>

    <section id="section-reunioes" class="glass-card" style="margin-top:20px">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
            <div class="header-with-sync" onclick="toggleReunioes()" title="Expandir/Recolher Reuni√µes">
                <span id="setaReunioes">‚ñº</span>
                <h2 style="margin:0">REUNI√ïES <span id="contadorReunioes"></span></h2>
                <button class="btn-sm-sync" onclick="event.stopPropagation(); carregarDadosDoServidor()" title="Sincronizar Reuni√µes">üîÑ</button>
            </div>
            <button class="btn-accent" onclick="novaReuniao()" title="Agendar nova reuni√£o">+ Nova Reuni√£o</button>
        </div>
        <div id="listaReunioes"></div>
    </section>

    <section id="section-projetos" class="glass-card" style="margin-top:20px">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
            <div class="header-with-sync" onclick="toggleProjetos()" title="Expandir/Recolher Projetos">
                <span id="setaProjetos">‚ñº</span>
                <h2 style="margin:0">PROJETOS <span id="contadorProjetos"></span></h2>
                <button class="btn-sm-sync" onclick="event.stopPropagation(); carregarDadosDoServidor()" title="Sincronizar Projetos">üîÑ</button>
            </div>
            <button class="btn-accent" onclick="novoProjeto()" title="Criar novo projeto">+ Novo Projeto</button>
        </div>
        <div id="listaProjetos"></div>
    </section>
</main>

<div id="modalSorteio" class="modal"><div class="modal-content"><h3>Sortear</h3><div id="elegiveisContainer" class="chip-container"></div><input type="number" id="qtdTotal" value="1" style="margin-top:10px" title="Quantidade de agentes"><div style="margin-top:10px"><button onclick="confirmarSorteio()">Sortear</button> <button onclick="fecharModal()">Fechar</button></div></div></div>
<div id="modalSorteioDemanda" class="modal"><div class="modal-content"><h3>Sortear Demanda</h3><div id="elegiveisDemandaContainer" class="chip-container"></div><input type="number" id="qtdTotalDem" placeholder="Qtd"><div style="margin-top:10px"><button onclick="confirmarSorteioDemanda()">Sortear</button> <button onclick="fecharModalDemanda()">Fechar</button></div></div></div>
<div id="modalDemandasConcluidas" class="modal"><div class="modal-content" style="max-width:800px"><h3>Conclu√≠das</h3><div id="listaDemandasConcluidas" style="max-height:400px;overflow-y:auto"></div><button style="width:100%;margin-top:10px" onclick="fecharDemandasConcluidas()">Fechar</button></div></div>
<div id="modalProjeto" class="modal"><div class="modal-content" style="max-width:700px"><h3>Descri√ß√£o</h3><div id="editorProjeto" style="height:250px;background:white"></div><button style="width:100%;margin-top:10px" onclick="gravarDescricaoProjeto()">Gravar</button> <button onclick="fecharModalProjeto()" style="margin-top:5px;width:100%;background:#eee">Cancelar</button></div></div>
<div id="modalData" class="modal"><div class="modal-content"><h3>Data</h3><button onclick="definirDataRapida('AMANH√É')">Amanh√£</button> <button onclick="definirDataRapida('SEMANA')">Semana</button><hr><input type="date" id="dataEsp"><button onclick="gerarEscalaCustom('especifica')">Gerar Data</button><hr><input type="date" id="dataIni"><input type="date" id="dataFim"><button onclick="gerarEscalaCustom('periodo')">Gerar Per√≠odo</button><button onclick="fecharModalData()" style="background:#eee;margin-top:10px">Cancelar</button></div></div>

</body>
</html>